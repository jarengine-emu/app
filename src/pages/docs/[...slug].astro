---
import { getCollection, type CollectionEntry } from "astro:content";
import PageLayout from "@/layouts/Base.astro";
import { siteConfig } from "@/site.config";

export async function getStaticPaths() {
	const docs = await getCollection("docs");
	return docs.map((doc) => ({
		params: { slug: doc.slug },
		props: { doc },
	}));
}

type Props = {
	doc: CollectionEntry<"docs">;
};

const { doc } = Astro.props;
const { Content } = await doc.render();
---

<PageLayout meta={{ title: doc.data.title, description: doc.data.description || undefined }}>
	<article class="prose prose-sm sm:prose lg:prose-lg mx-auto max-w-4xl">
		<header class="mb-8 pb-6 border-b border-accent-2">
			<h1 class="title mb-4">{doc.data.title}</h1>
			{doc.data.description && (
				<p class="text-lg text-global-text/80 mb-4">
					{doc.data.description}
				</p>
			)}
			<div class="flex items-center gap-4 text-sm">
				<span class="text-accent bg-accent-2 px-3 py-1 rounded-full">
					{doc.data.category || "Documentation"}
				</span>
				<span class="text-global-text/60">
					Order: {doc.data.order || "N/A"}
				</span>
			</div>
		</header>

		<div class="prose-content">
			<Content />
		</div>

		<footer class="mt-12 pt-6 border-t border-accent-2">
			<div class="flex items-center justify-between">
				<a href={`${siteConfig.base}/docs/`} class="text-link hover:text-accent transition-colors">
					‚Üê Back to Documentation
				</a>
			</div>
		</footer>
	</article>
</PageLayout>
