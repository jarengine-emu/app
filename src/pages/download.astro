---
import PageLayout from "@/layouts/Base.astro";
---

<PageLayout meta={{ title: "Download" }}>
  <section class="flex flex-col items-center justify-center min-h-screen">
  <img src="/app/JE-logo.png" alt="App Logo" class="w-28 h-28 mb-6" />
    <h1 class="title mb-6">Download JarEngine</h1>
    <p class="mb-8 text-lg text-center max-w-xl">
      Get the latest version of the Cross Platform Capable J2ME Emulator for your OS.
    </p>
    <div class="flex flex-col gap-4 w-full max-w-md">
  <a href="https://github.com/nsomatrix/JarEngine/releases/download/v1.0.0/JarEngine-1.0.0.jar" target="_blank" rel="noopener" class="flex items-center gap-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" class="w-6 h-6"><path d="M1.5 5.5l12.5-1.8v12.1h-12.5v-10.3zm0 11.3h12.5v12.1l-12.5-1.8v-10.3zm14.1-12.1l14.9-2.2v14.3h-14.9v-12.1zm14.9 15.1v14.3l-14.9-2.2v-12.1h14.9z"/></svg>
        Download for Windows
      </a>
      <div class="relative w-full" style="z-index:20;">
        <button type="button" id="linux-install-btn" class="flex items-center gap-3 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-8 rounded transition-colors w-full">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" class="w-6 h-6"><path d="M16 2C8.268 2 2 8.268 2 16c0 7.732 6.268 14 14 14s14-6.268 14-14C30 8.268 23.732 2 16 2zm-4.5 23c-.828 0-1.5-.672-1.5-1.5S10.672 22 11.5 22s1.5.672 1.5 1.5S12.328 25 11.5 25zm9 0c-.828 0-1.5-.672-1.5-1.5s.672-1.5 1.5-1.5 1.5.672 1.5 1.5-.672 1.5-1.5 1.5zm4.5-5.5c-1.104 0-2-.896-2-2 0-.553.447-1 1-1s1 .447 1 1c0 .553-.447 1-1 1zm-15 0c-1.104 0-2-.896-2-2 0-.553.447-1 1-1s1 .447 1 1c0 .553-.447 1-1 1zm13.293-7.707l-1.414 1.414C19.105 10.105 17.553 9.5 16 9.5s-3.105.605-4.379 1.707l-1.414-1.414C12.105 8.105 14.053 7.5 16 7.5s3.895.605 5.293 1.793z"/></svg>
        Install on Linux
        </button>
        <div id="linux-install-popover" class="hidden fixed inset-0 z-50 flex items-center justify-center">
          <div class="relative bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-xl shadow-2xl p-8 flex flex-col items-center max-w-md w-full mx-4 max-h-[90vh] overflow-auto">
            <button type="button" aria-label="Close" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 dark:hover:text-white text-2xl font-bold bg-transparent border-none" id="close-linux-modal">&times;</button>
            <h2 class="text-xl font-semibold mb-6">Install on Linux</h2>
            <div class="w-full mb-6">
              <div class="bg-gray-100 dark:bg-gray-800 rounded px-3 py-2 font-mono text-base flex items-center justify-between">
                <span id="linux-install-cmd">bash &lt;(curl -sSL https://raw.githubusercontent.com/nsomatrix/JarEngine/refs/heads/main/scripts/jarengine.sh)</span>
                <button type="button" id="copy-linux-cmd" class="ml-2 px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs">Copy</button>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="relative w-full" style="z-index:20;">
        <button type="button" id="macos-install-btn" class="flex items-center gap-3 bg-gray-800 hover:bg-gray-900 text-white font-semibold py-3 px-8 rounded transition-colors w-full">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" class="w-6 h-6"><path d="M24.7 17.3c-.1-2.6 2.1-3.8 2.2-3.9-1.2-1.7-3-1.9-3.7-2-1.6-.2-3.1.9-3.9.9-.8 0-2-.9-3.3-.9-1.7 0-3.3 1-4.2 2.6-1.8 3.1-.5 7.7 1.3 10.2.9 1.3 2 2.7 3.4 2.6 1.3-.1 1.8-.8 3.3-.8s1.9.8 3.3.8c1.4 0 2.4-1.3 3.3-2.6.6-.9.8-1.8.8-1.9 0-.1-2.2-.8-2.3-3.1zm-4.2-6.1c.7-.8 1.2-2 1-3.2-1 .1-2.2.7-2.9 1.5-.6.7-1.2 1.9-1 3 .9.1 2.2-.5 2.9-1.3z"/></svg>
          Install on MacOS
        </button>
        <div id="macos-install-popover" class="hidden fixed inset-0 z-50 flex items-center justify-center">
          <div class="relative bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-xl shadow-2xl p-8 flex flex-col items-center max-w-md w-full mx-4 max-h-[90vh] overflow-auto">
            <button type="button" aria-label="Close" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 dark:hover:text-white text-2xl font-bold bg-transparent border-none" id="close-macos-modal">&times;</button>
            <h2 class="text-xl font-semibold mb-6">Install on MacOS</h2>
            <div class="w-full mb-6">
              <div class="bg-gray-100 dark:bg-gray-800 rounded px-3 py-2 font-mono text-base flex items-center justify-between">
                <span id="macos-install-cmd">bash &lt;(curl -sSL https://raw.githubusercontent.com/nsomatrix/JarEngine/refs/heads/main/scripts/jarengine-mac.sh)</span>
                <button type="button" id="copy-macos-cmd" class="ml-2 px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs">Copy</button>
              </div>
            </div>
          </div>
        </div>

</div>
<script>
  // Only one popover open at a time, and copy logic for both
  function closeAllPopovers() {
    const linuxPopover = document.getElementById('linux-install-popover');
    if (linuxPopover) linuxPopover.classList.add('hidden');
    const macosPopover = document.getElementById('macos-install-popover');
    if (macosPopover) macosPopover.classList.add('hidden');
  }
  document.addEventListener('DOMContentLoaded', function() {
    // Linux copy
    const copyBtn = document.getElementById('copy-linux-cmd');
    if (copyBtn) {
      copyBtn.onclick = function() {
        navigator.clipboard.writeText('bash <(curl -sSL https://raw.githubusercontent.com/nsomatrix/JarEngine/refs/heads/main/scripts/jarengine.sh)');
        copyBtn.textContent = 'Copied!';
        setTimeout(() => { copyBtn.textContent = 'Copy'; }, 1500);
      };
    }
    // MacOS copy
    const copyBtnMac = document.getElementById('copy-macos-cmd');
    if (copyBtnMac) {
      copyBtnMac.onclick = function() {
        navigator.clipboard.writeText('bash <(curl -sSL https://raw.githubusercontent.com/nsomatrix/JarEngine/refs/heads/main/scripts/jarengine-mac.sh)');
        copyBtnMac.textContent = 'Copied!';
        setTimeout(() => { copyBtnMac.textContent = 'Copy'; }, 1500);
      };
    }
    // Linux popover
    const linuxBtn = document.getElementById('linux-install-btn');
    if (linuxBtn) {
      linuxBtn.onclick = function() {
        closeAllPopovers();
        const linuxPopover = document.getElementById('linux-install-popover');
        if (linuxPopover) linuxPopover.classList.remove('hidden');
      };
    }
    // MacOS popover
    const macosBtn = document.getElementById('macos-install-btn');
    if (macosBtn) {
      macosBtn.onclick = function() {
        closeAllPopovers();
        const macosPopover = document.getElementById('macos-install-popover');
        if (macosPopover) macosPopover.classList.remove('hidden');
      };
    }
    // Close buttons (top-right X)
    const closeLinux = document.getElementById('close-linux-modal');
    if (closeLinux) closeLinux.onclick = closeAllPopovers;
    const closeMacos = document.getElementById('close-macos-modal');
    if (closeMacos) closeMacos.onclick = closeAllPopovers;
    // ESC key closes modals
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeAllPopovers();
    });
  });
</script>
      </div>
    </div>
  </section>
</PageLayout>
